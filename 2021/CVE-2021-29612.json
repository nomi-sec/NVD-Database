{
    "id": "CVE-2021-29612",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2021-05-14T20:15:15.990",
    "lastModified": "2024-11-21T06:01:29.567",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "TensorFlow is an end-to-end open source platform for machine learning. An attacker can trigger a heap buffer overflow in Eigen implementation of `tf.raw_ops.BandedTriangularSolve`. The implementation(https:\/\/github.com\/tensorflow\/tensorflow\/blob\/eccb7ec454e6617738554a255d77f08e60ee0808\/tensorflow\/core\/kernels\/linalg\/banded_triangular_solve_op.cc#L269-L278) calls `ValidateInputTensors` for input validation but fails to validate that the two tensors are not empty. Furthermore, since `OP_REQUIRES` macro only stops execution of current function after setting `ctx->status()` to a non-OK value, callers of helper functions that use `OP_REQUIRES` must check value of `ctx->status()` before continuing. This doesn't happen in this op's implementation(https:\/\/github.com\/tensorflow\/tensorflow\/blob\/eccb7ec454e6617738554a255d77f08e60ee0808\/tensorflow\/core\/kernels\/linalg\/banded_triangular_solve_op.cc#L219), hence the validation that is present is also not effective. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range."
        },
        {
            "lang": "es",
            "value": "TensorFlow es una plataforma de c\u00f3digo abierto de extremo a extremo para el aprendizaje autom\u00e1tico.&#xa0;Un atacante puede desencadenar un desbordamiento del b\u00fafer en una implementaci\u00f3n de Eigen de \"tf.raw_ops.BandedTriangularSolve\".&#xa0;La implementaci\u00f3n (https:\/\/github.com\/tensorflow\/tensorflow\/blob\/eccb7ec454e6617738554a255d77f08e60ee0808\/tensorflow\/core\/kernels\/linalg\/banded_triangular_solve_op.cc#L269-L278) llama a \"ValidateInputTensors\" no est\u00e1n vac\u00edas.&#xa0;Adem\u00e1s, dado que la macro \"OP_REQUIRES\" solo detiene una ejecuci\u00f3n de la funci\u00f3n actual despu\u00e9s de configurar la funci\u00f3n \"ctx-)status()\" a un valor que no es OK, los llamadores de funciones auxiliares que usan \"OP_REQUIRES\" deben comprobar el valor de \"ctx-)status()\" antes de continuar.&#xa0;Esto no sucede en una implementaci\u00f3n de esta operaci\u00f3n (https:\/\/github.&#xa0;com\/tensorflow\/tensorflow\/blob\/eccb7ec454e6617738554a255d77f08e60ee0808\/tensorflow\/core\/kernels\/linalg\/banded_triangular_solve_op.cc#L219), por lo tanto, Una comprobaci\u00f3n que est\u00e1 presente tampoco es efectiva.&#xa0;La correcci\u00f3n ser\u00e1 inclu\u00edda en TensorFlow versi\u00f3n 2.5.0.&#xa0;Tambi\u00e9n seleccionaremos este commit en TensorFlow versi\u00f3n 2.4.2, TensorFlow versi\u00f3n 2.3.3, TensorFlow versi\u00f3n 2.2.3 y TensorFlow versi\u00f3n 2.1.4, ya que estos tambi\u00e9n est\u00e1n afectados y a\u00fan est\u00e1n en el rango compatible"
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:L\/AC:H\/PR:L\/UI:N\/S:U\/C:N\/I:L\/A:L",
                    "baseScore": 3.6,
                    "baseSeverity": "LOW",
                    "attackVector": "LOCAL",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "LOW",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "NONE",
                    "integrityImpact": "LOW",
                    "availabilityImpact": "LOW"
                },
                "exploitabilityScore": 1,
                "impactScore": 2.5
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:L\/AC:L\/PR:L\/UI:N\/S:U\/C:H\/I:H\/A:H",
                    "baseScore": 7.8,
                    "baseSeverity": "HIGH",
                    "attackVector": "LOCAL",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "LOW",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 1.8,
                "impactScore": 5.9
            }
        ],
        "cvssMetricV2": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "2.0",
                    "vectorString": "AV:L\/AC:L\/Au:N\/C:P\/I:P\/A:P",
                    "baseScore": 4.6,
                    "accessVector": "LOCAL",
                    "accessComplexity": "LOW",
                    "authentication": "NONE",
                    "confidentialityImpact": "PARTIAL",
                    "integrityImpact": "PARTIAL",
                    "availabilityImpact": "PARTIAL"
                },
                "baseSeverity": "MEDIUM",
                "exploitabilityScore": 3.9,
                "impactScore": 6.4,
                "acInsufInfo": false,
                "obtainAllPrivilege": false,
                "obtainUserPrivilege": false,
                "obtainOtherPrivilege": false,
                "userInteractionRequired": false
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-120"
                }
            ]
        },
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-787"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "2.1.4",
                            "matchCriteriaId": "323ABCCE-24EB-47CC-87F6-48C101477587"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.2.0",
                            "versionEndExcluding": "2.2.3",
                            "matchCriteriaId": "64ABA90C-0649-4BB0-89C9-83C14BBDCC0F"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.3.0",
                            "versionEndExcluding": "2.3.3",
                            "matchCriteriaId": "0F83E0CF-CBF6-4C24-8683-3E7A5DC95BA9"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.4.0",
                            "versionEndExcluding": "2.4.2",
                            "matchCriteriaId": "8259531B-A8AC-4F8B-B60F-B69DE4767C03"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https:\/\/github.com\/tensorflow\/tensorflow\/commit\/0ab290774f91a23bebe30a358fde4e53ab4876a0",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/tensorflow\/tensorflow\/commit\/ba6822bd7b7324ba201a28b2f278c29a98edbef2",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/tensorflow\/tensorflow\/security\/advisories\/GHSA-2xgj-xhgf-ggjv",
            "source": "security-advisories@github.com",
            "tags": [
                "Exploit",
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/tensorflow\/tensorflow\/commit\/0ab290774f91a23bebe30a358fde4e53ab4876a0",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/tensorflow\/tensorflow\/commit\/ba6822bd7b7324ba201a28b2f278c29a98edbef2",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/tensorflow\/tensorflow\/security\/advisories\/GHSA-2xgj-xhgf-ggjv",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Exploit",
                "Patch",
                "Third Party Advisory"
            ]
        }
    ]
}