{
    "cve": {
        "id": "CVE-2021-20134",
        "sourceIdentifier": "vulnreport@tenable.com",
        "published": "2021-12-30T22:15:08.460",
        "lastModified": "2024-11-21T05:45:59.307",
        "vulnStatus": "Modified",
        "cveTags": [],
        "descriptions": [
            {
                "lang": "en",
                "value": "Quagga Services on D-Link DIR-2640 less than or equal to version 1.11B02 are affected by an absolute path traversal vulnerability that allows a remote, authenticated attacker to set an arbitrary file on the router's filesystem as the log file used by either Quagga service (zebra or ripd). Subsequent log messages will be appended to the file, prefixed by a timestamp and some logging metadata. Remote code execution can be achieved by using this vulnerability to append to a shell script on the router's filesystem, and then awaiting or triggering the execution of that script. A remote, unauthenticated root shell can easily be obtained on the device in this fashion."
            },
            {
                "lang": "es",
                "value": "Los servicios Quagga en D-Link DIR-2640 menores o iguales a la versi\u00f3n 1.11B02, est\u00e1n afectados por una vulnerabilidad de salto de ruta absoluto que permite a un atacante remoto y autenticado establecer un archivo arbitrario en el sistema de archivos del router como el archivo de registro usado por cualquiera de los servicios Quagga (zebra o ripd). Los mensajes de registro subsiguientes ser\u00e1n a\u00f1adidos al archivo, precedidos por una marca de tiempo y algunos metadatos de registro. Una ejecuci\u00f3n de c\u00f3digo remota puede lograrse usando esta vulnerabilidad para anexar a un script de shell en el sistema de archivos del router, y luego esperar o desencadenar la ejecuci\u00f3n de ese script. De este modo, puede obtenerse f\u00e1cilmente un shell remoto y no autenticado en el dispositivo.\n"
            }
        ],
        "metrics": {
            "cvssMetricV31": [
                {
                    "source": "nvd@nist.gov",
                    "type": "Primary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:A\/AC:L\/PR:H\/UI:N\/S:C\/C:H\/I:H\/A:H",
                        "baseScore": 8.4,
                        "baseSeverity": "HIGH",
                        "attackVector": "ADJACENT_NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "HIGH",
                        "userInteraction": "NONE",
                        "scope": "CHANGED",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "availabilityImpact": "HIGH"
                    },
                    "exploitabilityScore": 1.7,
                    "impactScore": 6
                }
            ],
            "cvssMetricV2": [
                {
                    "source": "nvd@nist.gov",
                    "type": "Primary",
                    "cvssData": {
                        "version": "2.0",
                        "vectorString": "AV:A\/AC:M\/Au:S\/C:C\/I:C\/A:C",
                        "baseScore": 7.4,
                        "accessVector": "ADJACENT_NETWORK",
                        "accessComplexity": "MEDIUM",
                        "authentication": "SINGLE",
                        "confidentialityImpact": "COMPLETE",
                        "integrityImpact": "COMPLETE",
                        "availabilityImpact": "COMPLETE"
                    },
                    "baseSeverity": "HIGH",
                    "exploitabilityScore": 4.4,
                    "impactScore": 10,
                    "acInsufInfo": false,
                    "obtainAllPrivilege": false,
                    "obtainUserPrivilege": false,
                    "obtainOtherPrivilege": false,
                    "userInteractionRequired": false
                }
            ]
        },
        "weaknesses": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "description": [
                    {
                        "lang": "en",
                        "value": "CWE-22"
                    }
                ]
            }
        ],
        "configurations": [
            {
                "operator": "AND",
                "nodes": [
                    {
                        "operator": "OR",
                        "negate": false,
                        "cpeMatch": [
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:o:dlink:dir-2640-us_firmware:*:*:*:*:*:*:*:*",
                                "versionEndIncluding": "1.11b02",
                                "matchCriteriaId": "ACE0B76E-0581-4A2B-92D2-A1D7A93B098E"
                            }
                        ]
                    },
                    {
                        "operator": "OR",
                        "negate": false,
                        "cpeMatch": [
                            {
                                "vulnerable": false,
                                "criteria": "cpe:2.3:h:dlink:dir-2640-us:-:*:*:*:*:*:*:*",
                                "matchCriteriaId": "894C2BD1-B610-4F15-864E-92D6B515488D"
                            }
                        ]
                    }
                ]
            }
        ],
        "references": [
            {
                "url": "https:\/\/www.tenable.com\/security\/research\/tra-2021-44",
                "source": "vulnreport@tenable.com",
                "tags": [
                    "Exploit",
                    "Third Party Advisory"
                ]
            },
            {
                "url": "https:\/\/www.tenable.com\/security\/research\/tra-2021-44",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Exploit",
                    "Third Party Advisory"
                ]
            }
        ]
    }
}