{
    "id": "CVE-2021-40348",
    "sourceIdentifier": "cve@mitre.org",
    "published": "2021-11-01T05:15:07.007",
    "lastModified": "2024-11-21T06:23:55.370",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "Spacewalk 2.10, and derivatives such as Uyuni 2021.08, allows code injection. rhn-config-satellite.pl doesn't sanitize the configuration filename used to append Spacewalk-specific key-value pair. The script is intended to be run by the tomcat user account with Sudo, according to the installation setup. This can lead to the ability of an attacker to use --option to append arbitrary code to a root-owned file that eventually will be executed by the system. This is fixed in Uyuni spacewalk-admin 4.3.2-1."
        },
        {
            "lang": "es",
            "value": "Spacewalk versi\u00f3n 2.10, y sus derivados como Uyuni versi\u00f3n 2021.08, permiten la inyecci\u00f3n de c\u00f3digo. El archivo rhn-config-satellite.pl no sanea el nombre del archivo de configuraci\u00f3n usado para a\u00f1adir el par clave-valor espec\u00edfico de Spacewalk. El script est\u00e1 pensado para ser ejecutado por la cuenta de usuario tomcat con Sudo, seg\u00fan la configuraci\u00f3n de la instalaci\u00f3n. Esto puede conllevar a la posibilidad de que un atacante use la opci\u00f3n --option para anexar c\u00f3digo arbitrario a un archivo propiedad de root que finalmente ser\u00e1 ejecutado por el sistema. Esto es corregido en Uyuni spacewalk-admin versi\u00f3n 4.3.2-1"
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:R\/S:U\/C:H\/I:H\/A:H",
                    "baseScore": 8.8,
                    "baseSeverity": "HIGH",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "REQUIRED",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 2.8,
                "impactScore": 5.9
            }
        ],
        "cvssMetricV2": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "2.0",
                    "vectorString": "AV:N\/AC:M\/Au:N\/C:C\/I:C\/A:C",
                    "baseScore": 9.3,
                    "accessVector": "NETWORK",
                    "accessComplexity": "MEDIUM",
                    "authentication": "NONE",
                    "confidentialityImpact": "COMPLETE",
                    "integrityImpact": "COMPLETE",
                    "availabilityImpact": "COMPLETE"
                },
                "baseSeverity": "HIGH",
                "exploitabilityScore": 8.6,
                "impactScore": 10,
                "acInsufInfo": false,
                "obtainAllPrivilege": false,
                "obtainUserPrivilege": false,
                "obtainOtherPrivilege": false,
                "userInteractionRequired": true
            }
        ]
    },
    "weaknesses": [
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-94"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:uyuni-project:uyuni:2021.08:*:*:*:*:*:*:*",
                            "matchCriteriaId": "A411E9FA-C3C6-4252-8D1D-FEEDBC285DEE"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:spacewalk_project:spacewalk:2.10:*:*:*:*:*:*:*",
                            "matchCriteriaId": "D8FEE004-A489-493A-9C40-A10E708C0099"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "http:\/\/www.openwall.com\/lists\/oss-security\/2021\/10\/28\/4",
            "source": "cve@mitre.org",
            "tags": [
                "Exploit",
                "Mailing List",
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/uyuni-project\/uyuni\/commit\/790c7388efac6923c5475e01c1ff718dffa9f052",
            "source": "cve@mitre.org",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "http:\/\/www.openwall.com\/lists\/oss-security\/2021\/10\/28\/4",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Exploit",
                "Mailing List",
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/uyuni-project\/uyuni\/commit\/790c7388efac6923c5475e01c1ff718dffa9f052",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        }
    ]
}