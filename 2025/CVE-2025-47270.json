{
    "id": "CVE-2025-47270",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2025-05-12T11:15:51.050",
    "lastModified": "2025-05-12T17:32:32.760",
    "vulnStatus": "Awaiting Analysis",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "nimiq\/core-rs-albatross is a Rust implementation of the Nimiq Proof-of-Stake protocol based on the Albatross consensus algorithm. The `nimiq-network-libp2p` subcrate of nimiq\/core-rs-albatross is vulnerable to a Denial of Service (DoS) attack due to uncontrolled memory allocation. Specifically, the implementation of the `Discovery` network message handling allocates a buffer based on a length value provided by the peer, without enforcing an upper bound. Since this length is a `u32`, a peer can trigger allocations of up to 4 GB, potentially leading to memory exhaustion and node crashes. As Discovery messages are regularly exchanged for peer discovery, this vulnerability can be exploited repeatedly. The patch for this vulnerability is formally released as part of v1.1.0. The patch implements a limit to the discovery message size of 1 MB and also resizes the message buffer size incrementally as the data is read. No known workarounds are available."
        },
        {
            "lang": "es",
            "value": "nimiq\/core-rs-albatross es una implementaci\u00f3n en Rust del protocolo Nimiq Proof-of-Stake, basado en el algoritmo de consenso Albatross. La subcaja `nimiq-network-libp2p` de nimiq\/core-rs-albatross es vulnerable a un ataque de denegaci\u00f3n de servicio (DoS) debido a la asignaci\u00f3n de memoria incontrolada. En concreto, la implementaci\u00f3n del sistema de gesti\u00f3n de mensajes de red `Discovery` asigna un b\u00fafer seg\u00fan la longitud proporcionada por el par, sin imponer un l\u00edmite superior. Dado que esta longitud es `u32`, un par puede activar asignaciones de hasta 4 GB, lo que podr\u00eda provocar el agotamiento de la memoria y ca\u00eddas del nodo. Dado que los mensajes de Discovery se intercambian regularmente para el descubrimiento de pares, esta vulnerabilidad puede explotarse repetidamente. El parche para esta vulnerabilidad se public\u00f3 oficialmente como parte de la versi\u00f3n 1.1.0. El parche implementa un l\u00edmite de 1 MB para el tama\u00f1o de los mensajes de descubrimiento y tambi\u00e9n ajusta el tama\u00f1o del b\u00fafer de mensajes de forma incremental a medida que se leen los datos. No se conocen workarounds."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:N\/S:U\/C:N\/I:N\/A:H",
                    "baseScore": 7.5,
                    "baseSeverity": "HIGH",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "NONE",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 3.6
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-400"
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https:\/\/github.com\/nimiq\/core-rs-albatross\/pull\/3384",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https:\/\/github.com\/nimiq\/core-rs-albatross\/releases\/tag\/v1.1.0",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https:\/\/github.com\/nimiq\/core-rs-albatross\/security\/advisories\/GHSA-3v6r-9cr8-q433",
            "source": "security-advisories@github.com"
        }
    ]
}