{
    "id": "CVE-2022-29165",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2022-05-20T15:15:10.210",
    "lastModified": "2024-11-21T06:58:37.283",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. A critical vulnerability has been discovered in Argo CD starting with version 1.4.0 and prior to versions 2.1.15, 2.2.9, and 2.3.4 which would allow unauthenticated users to impersonate as any Argo CD user or role, including the `admin` user, by sending a specifically crafted JSON Web Token (JWT) along with the request. In order for this vulnerability to be exploited, anonymous access to the Argo CD instance must have been enabled. In a default Argo CD installation, anonymous access is disabled. The vulnerability can be exploited to impersonate as any user or role, including the built-in `admin` account regardless of whether it is enabled or disabled. Also, the attacker does not need an account on the Argo CD instance in order to exploit this. If anonymous access to the instance is enabled, an attacker can escalate their privileges, effectively allowing them to gain the same privileges on the cluster as the Argo CD instance, which is cluster admin in a default installation. This will allow the attacker to create, manipulate and delete any resource on the cluster. They may also exfiltrate data by deploying malicious workloads with elevated privileges, thus bypassing any redaction of sensitive data otherwise enforced by the Argo CD API. A patch for this vulnerability has been released in Argo CD versions 2.3.4, 2.2.9, and 2.1.15. As a workaround, one may disable anonymous access, but upgrading to a patched version is preferable."
        },
        {
            "lang": "es",
            "value": "Argo CD es una herramienta declarativa de entrega continua GitOps para Kubernetes. Se ha detectado una vulnerabilidad cr\u00edtica en Argo CD a partir de la versi\u00f3n 1.4.0 y versiones anteriores a 2.1.15, 2.2.9 y 2.3.4 que permitir\u00eda a usuarios no autenticados hacerse pasar por cualquier usuario o rol de Argo CD, incluido el usuario \"admin\", mediante el env\u00edo de un Token Web JSON (JWT) espec\u00edficamente dise\u00f1ado junto con la petici\u00f3n. Para que esta vulnerabilidad pueda ser explotada, el acceso an\u00f3nimo a la instancia de CD Argo debe estar habilitado. En una instalaci\u00f3n por defecto de Argo CD, el acceso an\u00f3nimo est\u00e1 deshabilitado. La vulnerabilidad puede ser explotada para hacerse pasar por cualquier usuario o rol, incluyendo la cuenta \"admin\" incorporada, independientemente de si est\u00e1 habilitada o deshabilitada. Adem\u00e1s, el atacante no necesita una cuenta en la instancia de CD Argo para poder explotar esto. Si el acceso an\u00f3nimo a la instancia est\u00e1 habilitado, un atacante puede escalar sus privilegios, permiti\u00e9ndole alcanzar los mismos privilegios en el cluster que la instancia de CD Argo, que es el administrador del cluster en una instalaci\u00f3n por defecto. Esto permitir\u00e1 al atacante crear, manipular y eliminar cualquier recurso en el cl\u00faster. Tambi\u00e9n pueden exfiltrar datos al desplegar cargas de trabajo maliciosas con privilegios elevados, eludiendo as\u00ed cualquier redacci\u00f3n de datos confidenciales que la API de CD de Argo pueda aplicar. Ha sido publicado un parche para esta vulnerabilidad en las versiones 2.3.4, 2.2.9 y 2.1.15 del CD Argo. Como mitigaci\u00f3n, puede deshabilitarse el acceso an\u00f3nimo, pero es preferible actualizar a una versi\u00f3n parcheada"
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:N\/S:C\/C:H\/I:H\/A:H",
                    "baseScore": 10,
                    "baseSeverity": "CRITICAL",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "CHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 6
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:N\/S:C\/C:H\/I:H\/A:H",
                    "baseScore": 10,
                    "baseSeverity": "CRITICAL",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "CHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 6
            }
        ],
        "cvssMetricV2": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "2.0",
                    "vectorString": "AV:N\/AC:M\/Au:N\/C:C\/I:C\/A:C",
                    "baseScore": 9.3,
                    "accessVector": "NETWORK",
                    "accessComplexity": "MEDIUM",
                    "authentication": "NONE",
                    "confidentialityImpact": "COMPLETE",
                    "integrityImpact": "COMPLETE",
                    "availabilityImpact": "COMPLETE"
                },
                "baseSeverity": "HIGH",
                "exploitabilityScore": 8.6,
                "impactScore": 10,
                "acInsufInfo": false,
                "obtainAllPrivilege": false,
                "obtainUserPrivilege": false,
                "obtainOtherPrivilege": false,
                "userInteractionRequired": false
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-200"
                },
                {
                    "lang": "en",
                    "value": "CWE-287"
                },
                {
                    "lang": "en",
                    "value": "CWE-290"
                }
            ]
        },
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-290"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:argoproj:argo_cd:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "1.4.0",
                            "versionEndExcluding": "2.1.15",
                            "matchCriteriaId": "1E2FF44B-FAFD-4B1E-9B15-357F5D1523BC"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:argoproj:argo_cd:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.2.0",
                            "versionEndExcluding": "2.2.9",
                            "matchCriteriaId": "97EADC28-ADC0-4B9E-BBDB-E2EF244B4BD9"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:argoproj:argo_cd:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.3.0",
                            "versionEndExcluding": "2.3.4",
                            "matchCriteriaId": "21A2130E-E263-4B62-B75D-E0631020E8E0"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https:\/\/github.com\/argoproj\/argo-cd\/releases\/tag\/v2.1.15",
            "source": "security-advisories@github.com",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/argoproj\/argo-cd\/releases\/tag\/v2.2.9",
            "source": "security-advisories@github.com",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/argoproj\/argo-cd\/releases\/tag\/v2.3.4",
            "source": "security-advisories@github.com",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/argoproj\/argo-cd\/security\/advisories\/GHSA-r642-gv9p-2wjj",
            "source": "security-advisories@github.com",
            "tags": [
                "Mitigation",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/argoproj\/argo-cd\/releases\/tag\/v2.1.15",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/argoproj\/argo-cd\/releases\/tag\/v2.2.9",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/argoproj\/argo-cd\/releases\/tag\/v2.3.4",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/argoproj\/argo-cd\/security\/advisories\/GHSA-r642-gv9p-2wjj",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Mitigation",
                "Third Party Advisory"
            ]
        }
    ]
}