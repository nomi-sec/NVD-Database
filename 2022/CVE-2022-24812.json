{
    "cve": {
        "id": "CVE-2022-24812",
        "sourceIdentifier": "security-advisories@github.com",
        "published": "2022-04-12T17:15:09.503",
        "lastModified": "2024-11-21T06:51:09.210",
        "vulnStatus": "Modified",
        "cveTags": [],
        "descriptions": [
            {
                "lang": "en",
                "value": "Grafana is an open-source platform for monitoring and observability. When fine-grained access control is enabled and a client uses Grafana API Key to make requests, the permissions for that API Key are cached for 30 seconds for the given organization. Because of the way the cache ID is constructed, the consequent requests with any API Key evaluate to the same permissions as the previous requests. This can lead to an escalation of privileges, when for example a first request is made with Admin permissions, and the second request with different API Key is made with Viewer permissions, the second request will get the cached permissions from the previous Admin, essentially accessing higher privilege than it should. The vulnerability is only impacting Grafana Enterprise when the fine-grained access control beta feature is enabled and there are more than one API Keys in one organization with different roles assigned. All installations after Grafana Enterprise v8.1.0-beta1 should be upgraded as soon as possible. As an alternative, disable fine-grained access control will mitigate the vulnerability."
            },
            {
                "lang": "es",
                "value": "Grafana es una plataforma de c\u00f3digo abierto para la monitorizaci\u00f3n y la observabilidad. Cuando el control de acceso de grano fino est\u00e1 habilitado y un cliente usa la API Key de Grafana para hacer peticiones, los permisos para esa API Key se almacenan en cach\u00e9 durante 30 segundos para la organizaci\u00f3n dada. Debido a la forma en que es construida el ID de la cach\u00e9, las peticiones consecuentes con cualquier API Key son evaluadas con los mismos permisos que las peticiones anteriores. Esto puede conllevar a una escalada de privilegios, cuando por ejemplo una primera petici\u00f3n es realizada con permisos de Administrador, y la segunda petici\u00f3n con diferente API Key es realizada con permisos de Visor, la segunda petici\u00f3n obtendr\u00e1 los permisos almacenados en cach\u00e9 del Administrador anterior, accediendo esencialmente a un privilegio mayor del que deber\u00eda. La vulnerabilidad s\u00f3lo afecta a Grafana Enterprise cuando la funci\u00f3n beta de control de acceso de grano fino est\u00e1 habilitada y presenta m\u00e1s de una API Key en una organizaci\u00f3n con diferentes roles asignados. Todas las instalaciones posteriores a Grafana Enterprise v8.1.0-beta1 deber\u00edan actualizarse lo antes posible. Como alternativa, deshabilitar el control de acceso de grano fino mitigar\u00e1 la vulnerabilidad"
            }
        ],
        "metrics": {
            "cvssMetricV31": [
                {
                    "source": "security-advisories@github.com",
                    "type": "Secondary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:H\/PR:H\/UI:N\/S:C\/C:H\/I:H\/A:H",
                        "baseScore": 8,
                        "baseSeverity": "HIGH",
                        "attackVector": "NETWORK",
                        "attackComplexity": "HIGH",
                        "privilegesRequired": "HIGH",
                        "userInteraction": "NONE",
                        "scope": "CHANGED",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "availabilityImpact": "HIGH"
                    },
                    "exploitabilityScore": 1.3,
                    "impactScore": 6
                },
                {
                    "source": "nvd@nist.gov",
                    "type": "Primary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:L\/UI:N\/S:U\/C:H\/I:H\/A:H",
                        "baseScore": 8.8,
                        "baseSeverity": "HIGH",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "LOW",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "availabilityImpact": "HIGH"
                    },
                    "exploitabilityScore": 2.8,
                    "impactScore": 5.9
                }
            ],
            "cvssMetricV2": [
                {
                    "source": "nvd@nist.gov",
                    "type": "Primary",
                    "cvssData": {
                        "version": "2.0",
                        "vectorString": "AV:N\/AC:M\/Au:S\/C:P\/I:P\/A:P",
                        "baseScore": 6,
                        "accessVector": "NETWORK",
                        "accessComplexity": "MEDIUM",
                        "authentication": "SINGLE",
                        "confidentialityImpact": "PARTIAL",
                        "integrityImpact": "PARTIAL",
                        "availabilityImpact": "PARTIAL"
                    },
                    "baseSeverity": "MEDIUM",
                    "exploitabilityScore": 6.8,
                    "impactScore": 6.4,
                    "acInsufInfo": false,
                    "obtainAllPrivilege": false,
                    "obtainUserPrivilege": false,
                    "obtainOtherPrivilege": false,
                    "userInteractionRequired": false
                }
            ]
        },
        "weaknesses": [
            {
                "source": "security-advisories@github.com",
                "type": "Primary",
                "description": [
                    {
                        "lang": "en",
                        "value": "CWE-269"
                    }
                ]
            }
        ],
        "configurations": [
            {
                "nodes": [
                    {
                        "operator": "OR",
                        "negate": false,
                        "cpeMatch": [
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:enterprise:*:*:*",
                                "versionStartIncluding": "8.1.0",
                                "versionEndExcluding": "8.4.6",
                                "matchCriteriaId": "78D22073-11CA-4ED7-8A39-2DA3E142A74E"
                            }
                        ]
                    }
                ]
            }
        ],
        "references": [
            {
                "url": "https:\/\/github.com\/grafana\/grafana\/security\/advisories\/GHSA-82gq-xfg3-5j7v",
                "source": "security-advisories@github.com",
                "tags": [
                    "Patch",
                    "Release Notes",
                    "Third Party Advisory"
                ]
            },
            {
                "url": "https:\/\/grafana.com\/blog\/2022\/04\/12\/grafana-enterprise-8.4.6-released-with-high-severity-security-fix\/",
                "source": "security-advisories@github.com",
                "tags": [
                    "Patch",
                    "Release Notes",
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/grafana.com\/docs\/grafana\/latest\/release-notes\/release-notes-8-4-6\/",
                "source": "security-advisories@github.com",
                "tags": [
                    "Release Notes",
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/security.netapp.com\/advisory\/ntap-20220519-0005\/",
                "source": "security-advisories@github.com",
                "tags": [
                    "Third Party Advisory"
                ]
            },
            {
                "url": "https:\/\/github.com\/grafana\/grafana\/security\/advisories\/GHSA-82gq-xfg3-5j7v",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Patch",
                    "Release Notes",
                    "Third Party Advisory"
                ]
            },
            {
                "url": "https:\/\/grafana.com\/blog\/2022\/04\/12\/grafana-enterprise-8.4.6-released-with-high-severity-security-fix\/",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Patch",
                    "Release Notes",
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/grafana.com\/docs\/grafana\/latest\/release-notes\/release-notes-8-4-6\/",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Release Notes",
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/security.netapp.com\/advisory\/ntap-20220519-0005\/",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Third Party Advisory"
                ]
            }
        ]
    }
}