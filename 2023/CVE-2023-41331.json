{
    "id": "CVE-2023-41331",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2023-09-12T20:15:09.980",
    "lastModified": "2024-11-21T08:21:05.483",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "SOFARPC is a Java RPC framework. Versions prior to 5.11.0 are vulnerable to remote command execution. Through a carefully\ncrafted payload, an attacker can achieve JNDI injection or system command execution. In the default configuration of the SOFARPC framework, a blacklist is used to filter out dangerous classes encountered during the deserialization process. However, the blacklist is not comprehensive, and an actor can exploit certain native JDK classes and common third-party packages to construct gadget chains capable of achieving JNDI injection or system command execution attacks. Version 5.11.0 contains a fix for this issue. As a workaround, users can add `-Drpc_serialize_blacklist_override=javax.sound.sampled.AudioFileFormat` to the blacklist."
        },
        {
            "lang": "es",
            "value": "SOFARPC es un framework de Java RPC. Las versiones anteriores a la 5.11.0 son vulnerables a la ejecuci\u00f3n remota de comandos. A trav\u00e9s de un payload manipulado, un atacante puede lograr la inyecci\u00f3n JNDI o la ejecuci\u00f3n de comandos del sistema. En la configuraci\u00f3n predeterminada del framework SOFARPC, se utiliza una lista negra para filtrar las clases peligrosas encontradas durante el proceso de deserializaci\u00f3n. Sin embargo, la lista negra no es exhaustiva y un actor puede explotar ciertas clases nativas de JDK y paquetes comunes de terceros para construir cadenas de dispositivos capaces de lograr ataques de inyecci\u00f3n JNDI o ejecuci\u00f3n de comandos del sistema. La versi\u00f3n 5.11.0 contiene una soluci\u00f3n para este problema. Como workaround, los usuarios pueden agregar `-Drpc_serialize_blacklist_override=javax.sound.sampled.AudioFileFormat` a la lista negra."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:N\/S:U\/C:H\/I:H\/A:H",
                    "baseScore": 9.8,
                    "baseSeverity": "CRITICAL",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 5.9
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:N\/S:U\/C:H\/I:H\/A:H",
                    "baseScore": 9.8,
                    "baseSeverity": "CRITICAL",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 5.9
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-917"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:sofastack:sofarpc:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "5.11.0",
                            "matchCriteriaId": "ED8774FC-A1D7-4754-884F-E05FDDA111EE"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https:\/\/github.com\/sofastack\/sofa-rpc\/releases\/tag\/v5.11.0",
            "source": "security-advisories@github.com",
            "tags": [
                "Release Notes"
            ]
        },
        {
            "url": "https:\/\/github.com\/sofastack\/sofa-rpc\/security\/advisories\/GHSA-chv2-7hxj-2j86",
            "source": "security-advisories@github.com",
            "tags": [
                "Mitigation",
                "Vendor Advisory"
            ]
        },
        {
            "url": "https:\/\/github.com\/sofastack\/sofa-rpc\/releases\/tag\/v5.11.0",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Release Notes"
            ]
        },
        {
            "url": "https:\/\/github.com\/sofastack\/sofa-rpc\/security\/advisories\/GHSA-chv2-7hxj-2j86",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Mitigation",
                "Vendor Advisory"
            ]
        }
    ]
}