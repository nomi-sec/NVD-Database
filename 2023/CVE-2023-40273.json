{
    "cve": {
        "id": "CVE-2023-40273",
        "sourceIdentifier": "security@apache.org",
        "published": "2023-08-23T16:15:09.803",
        "lastModified": "2024-11-21T08:19:06.063",
        "vulnStatus": "Modified",
        "cveTags": [],
        "descriptions": [
            {
                "lang": "en",
                "value": "The session fixation vulnerability allowed the authenticated user to continue accessing Airflow webserver even after the password of the user has been reset by the admin - up until the expiry of the session of the user. Other than manually cleaning the session database (for database\u00a0session backend), or changing the secure_key and restarting the webserver, there were no mechanisms to force-logout the user (and all other users with that).\n\nWith this fix implemented, when using the\u00a0database\u00a0session backend, the existing sessions of the user are invalidated when the password of the user is reset. When using the securecookie\u00a0session backend, the sessions are NOT invalidated and still require changing the secure key and restarting the webserver (and logging out all other users), but the user resetting the password is informed about it with a flash message warning displayed in the UI. Documentation is also updated explaining this behaviour.\n\nUsers of Apache Airflow are advised to upgrade to version 2.7.0 or newer to mitigate the risk associated with this vulnerability.\n"
            },
            {
                "lang": "es",
                "value": "La vulnerabilidad de fijaci\u00f3n de sesi\u00f3n permit\u00eda al usuario autenticado seguir accediendo al servidor web de Airflow incluso despu\u00e9s de que el administrador hubiera restablecido la contrase\u00f1a del usuario, hasta la expiraci\u00f3n de la sesi\u00f3n del usuario. Aparte de limpiar manualmente la base de datos de sesiones (para el backend de sesi\u00f3n de base de datos), o cambiar la secure_key y reiniciar el servidor web, no hab\u00eda mecanismos para forzar el cierre de sesi\u00f3n del usuario (y de todos los dem\u00e1s usuarios). Con esta correcci\u00f3n implementada, cuando se utiliza el backend de sesi\u00f3n de base de datos, las sesiones existentes del usuario se invalidan cuando se restablece la contrase\u00f1a del usuario. Cuando se utiliza el backend de sesi\u00f3n securecookie, las sesiones NO se invalidan y sigue siendo necesario cambiar la clave segura y reiniciar el servidor web (y cerrar la sesi\u00f3n de todos los dem\u00e1s usuarios), pero el usuario que restablece la contrase\u00f1a es informado de ello con un mensaje flash de advertencia que se muestra en la interfaz de usuario. Tambi\u00e9n se ha actualizado la documentaci\u00f3n explicando este comportamiento. Se recomienda a los usuarios de Apache Airflow que actualicen a la versi\u00f3n 2.7.0 o posterior para mitigar el riesgo asociado a esta vulnerabilidad."
            }
        ],
        "metrics": {
            "cvssMetricV31": [
                {
                    "source": "nvd@nist.gov",
                    "type": "Primary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:L\/UI:R\/S:U\/C:H\/I:H\/A:H",
                        "baseScore": 8,
                        "baseSeverity": "HIGH",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "LOW",
                        "userInteraction": "REQUIRED",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "availabilityImpact": "HIGH"
                    },
                    "exploitabilityScore": 2.1,
                    "impactScore": 5.9
                },
                {
                    "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "type": "Secondary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:L\/UI:R\/S:U\/C:H\/I:H\/A:H",
                        "baseScore": 8,
                        "baseSeverity": "HIGH",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "LOW",
                        "userInteraction": "REQUIRED",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "availabilityImpact": "HIGH"
                    },
                    "exploitabilityScore": 2.1,
                    "impactScore": 5.9
                }
            ]
        },
        "weaknesses": [
            {
                "source": "security@apache.org",
                "type": "Primary",
                "description": [
                    {
                        "lang": "en",
                        "value": "CWE-384"
                    }
                ]
            }
        ],
        "configurations": [
            {
                "nodes": [
                    {
                        "operator": "OR",
                        "negate": false,
                        "cpeMatch": [
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:apache:airflow:*:*:*:*:*:*:*:*",
                                "versionEndIncluding": "2.7.0",
                                "matchCriteriaId": "4162BEC3-6BE2-41DB-BD89-4B4124E7F0C0"
                            }
                        ]
                    }
                ]
            }
        ],
        "references": [
            {
                "url": "https:\/\/github.com\/apache\/airflow\/pull\/33347",
                "source": "security@apache.org",
                "tags": [
                    "Third Party Advisory"
                ]
            },
            {
                "url": "https:\/\/lists.apache.org\/thread\/9rdmv8ln4y4ncbyrlmjrsj903x4l80nj",
                "source": "security@apache.org",
                "tags": [
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/www.openwall.com\/lists\/oss-security\/2023\/08\/23\/1",
                "source": "security@apache.org",
                "tags": [
                    "Mailing List",
                    "Third Party Advisory"
                ]
            },
            {
                "url": "https:\/\/github.com\/apache\/airflow\/pull\/33347",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Third Party Advisory"
                ]
            },
            {
                "url": "https:\/\/lists.apache.org\/thread\/9rdmv8ln4y4ncbyrlmjrsj903x4l80nj",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/www.openwall.com\/lists\/oss-security\/2023\/08\/23\/1",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Mailing List",
                    "Third Party Advisory"
                ]
            }
        ]
    }
}