{
    "cve": {
        "id": "CVE-2023-40177",
        "sourceIdentifier": "security-advisories@github.com",
        "published": "2023-08-23T21:15:08.670",
        "lastModified": "2024-11-21T08:18:56.180",
        "vulnStatus": "Modified",
        "cveTags": [],
        "descriptions": [
            {
                "lang": "en",
                "value": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Any registered user can use the content field of their user profile page to execute arbitrary scripts with programming rights, thus effectively performing rights escalation. This issue is present since version 4.3M2 when AppWithinMinutes Application added support for the Content field, allowing any wiki page (including the user profile page) to use its content as an AWM Content field, which has a custom displayer that executes the content with the rights of the ``AppWithinMinutes.Content`` author, rather than the rights of the content author. The vulnerability has been fixed in XWiki 14.10.5 and 15.1RC1. The fix is in the content of the AppWithinMinutes.Content page that defines the custom displayer. By using the ``display`` script service to render the content we make sure that the proper author is used for access rights checks."
            },
            {
                "lang": "es",
                "value": "XWiki Platform es una plataforma wiki gen\u00e9rica que ofrece servicios de ejecuci\u00f3n para aplicaciones construidas sobre ella. Cualquier usuario registrado puede utilizar el campo de contenido de su p\u00e1gina de perfil de usuario para ejecutar scripts arbitrarios con derechos de programaci\u00f3n, realizando as\u00ed una escalada de derechos. Este problema est\u00e1 presente desde la versi\u00f3n 4.3M2 cuando la aplicaci\u00f3n AppWithinMinutes a\u00f1adi\u00f3 soporte para el campo Content, permitiendo a cualquier p\u00e1gina wiki (incluyendo la p\u00e1gina de perfil de usuario) utilizar su contenido como un campo AWM Content, que tiene un visualizador personalizado que ejecuta el contenido con los derechos del autor ``AppWithinMinutes.Content``, en lugar de los derechos del autor del contenido. La vulnerabilidad ha sido corregida en XWiki 14.10.5 y 15.1RC1. La soluci\u00f3n se encuentra en el contenido de la p\u00e1gina AppWithinMinutes.Content que define el visualizador personalizado. Al utilizar el servicio de script ``display`` para mostrar el contenido, nos aseguramos de que se utiliza el autor adecuado para comprobar los derechos de acceso."
            }
        ],
        "metrics": {
            "cvssMetricV31": [
                {
                    "source": "security-advisories@github.com",
                    "type": "Secondary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:L\/UI:N\/S:C\/C:H\/I:H\/A:L",
                        "baseScore": 9.9,
                        "baseSeverity": "CRITICAL",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "LOW",
                        "userInteraction": "NONE",
                        "scope": "CHANGED",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "availabilityImpact": "LOW"
                    },
                    "exploitabilityScore": 3.1,
                    "impactScore": 6
                },
                {
                    "source": "nvd@nist.gov",
                    "type": "Primary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:L\/UI:N\/S:U\/C:H\/I:H\/A:H",
                        "baseScore": 8.8,
                        "baseSeverity": "HIGH",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "LOW",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "availabilityImpact": "HIGH"
                    },
                    "exploitabilityScore": 2.8,
                    "impactScore": 5.9
                }
            ]
        },
        "weaknesses": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "description": [
                    {
                        "lang": "en",
                        "value": "CWE-95"
                    }
                ]
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "description": [
                    {
                        "lang": "en",
                        "value": "CWE-94"
                    }
                ]
            }
        ],
        "configurations": [
            {
                "nodes": [
                    {
                        "operator": "OR",
                        "negate": false,
                        "cpeMatch": [
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*",
                                "versionStartIncluding": "4.3.1",
                                "versionEndExcluding": "14.10.5",
                                "matchCriteriaId": "822BD56F-3510-457D-81E0-8F29597FC352"
                            },
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:xwiki:xwiki:4.3:milestone2:*:*:*:*:*:*",
                                "matchCriteriaId": "F3AAC6FA-548D-4A38-A8FA-67E6D79641D4"
                            },
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:xwiki:xwiki:15.0:-:*:*:*:*:*:*",
                                "matchCriteriaId": "99329652-2907-4903-AAB1-1038F225C020"
                            },
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:xwiki:xwiki:15.0:rc1:*:*:*:*:*:*",
                                "matchCriteriaId": "88E41345-F81E-401A-BD67-66AF4B3925D4"
                            }
                        ]
                    }
                ]
            }
        ],
        "references": [
            {
                "url": "https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/dfb1cde173e363ca5c12eb3654869f9719820262",
                "source": "security-advisories@github.com",
                "tags": [
                    "Patch"
                ]
            },
            {
                "url": "https:\/\/github.com\/xwiki\/xwiki-platform\/security\/advisories\/GHSA-5mf8-v43w-mfxp",
                "source": "security-advisories@github.com",
                "tags": [
                    "Mitigation",
                    "Patch",
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/jira.xwiki.org\/browse\/XWIKI-7369",
                "source": "security-advisories@github.com",
                "tags": [
                    "Issue Tracking",
                    "Patch",
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/dfb1cde173e363ca5c12eb3654869f9719820262",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Patch"
                ]
            },
            {
                "url": "https:\/\/github.com\/xwiki\/xwiki-platform\/security\/advisories\/GHSA-5mf8-v43w-mfxp",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Mitigation",
                    "Patch",
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/jira.xwiki.org\/browse\/XWIKI-7369",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Issue Tracking",
                    "Patch",
                    "Vendor Advisory"
                ]
            }
        ]
    }
}