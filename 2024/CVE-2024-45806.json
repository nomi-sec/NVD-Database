{
    "cve": {
        "id": "CVE-2024-45806",
        "sourceIdentifier": "security-advisories@github.com",
        "published": "2024-09-20T00:15:02.293",
        "lastModified": "2024-10-15T16:03:44.943",
        "vulnStatus": "Analyzed",
        "cveTags": [],
        "descriptions": [
            {
                "lang": "en",
                "value": "Envoy is a cloud-native high-performance edge\/middle\/service proxy. A security vulnerability in Envoy allows external clients to manipulate Envoy headers, potentially leading to unauthorized access or other malicious actions within the mesh. This issue arises due to Envoy's default configuration of internal trust boundaries, which considers all RFC1918 private address ranges as internal. The default behavior for handling internal addresses in Envoy has been changed. Previously, RFC1918 IP addresses were automatically considered internal, even if the internal_address_config was empty.  The default configuration of Envoy will continue to trust internal addresses while in this release and it will not trust them by default in next release. If you have tooling such as probes on your private network which need to be treated as trusted (e.g. changing arbitrary x-envoy headers) please explicitly include those addresses or CIDR ranges into `internal_address_config`. Successful exploitation could allow attackers to bypass security controls, access sensitive data, or disrupt services within the mesh, like Istio. This issue has been addressed in versions 1.31.2, 1.30.6, 1.29.9, and 1.28.7. Users are advised to upgrade. There are no known workarounds for this vulnerability."
            },
            {
                "lang": "es",
                "value": "Envoy es un proxy de servicio, de borde y de medio alcance de alto rendimiento nativo de la nube. Una vulnerabilidad de seguridad en Envoy permite que los clientes externos manipulen los encabezados de Envoy, lo que puede provocar un acceso no autorizado u otras acciones maliciosas dentro de la malla. Este problema surge debido a la configuraci\u00f3n predeterminada de Envoy de los l\u00edmites de confianza internos, que considera todos los rangos de direcciones privadas RFC1918 como internos. Se ha cambiado el comportamiento predeterminado para manejar direcciones internas en Envoy. Anteriormente, las direcciones IP RFC1918 se consideraban internas autom\u00e1ticamente, incluso si internal_address_config estaba vac\u00edo. La configuraci\u00f3n predeterminada de Envoy seguir\u00e1 confiando en las direcciones internas mientras est\u00e9 en esta versi\u00f3n y no confiar\u00e1 en ellas de forma predeterminada en la pr\u00f3xima versi\u00f3n. Si tiene herramientas como sondas en su red privada que deben tratarse como confiables (por ejemplo, cambiando encabezados x-envoy arbitrarios), incluya expl\u00edcitamente esas direcciones o rangos CIDR en `internal_address_config`. Una explotaci\u00f3n exitosa podr\u00eda permitir a los atacantes eludir los controles de seguridad, acceder a datos confidenciales o interrumpir servicios dentro de la malla, como Istio. Este problema se ha solucionado en las versiones 1.31.2, 1.30.6, 1.29.9 y 1.28.7. Se recomienda a los usuarios que actualicen la versi\u00f3n. No se conocen workarounds para esta vulnerabilidad."
            }
        ],
        "metrics": {
            "cvssMetricV31": [
                {
                    "source": "security-advisories@github.com",
                    "type": "Secondary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:N\/S:U\/C:L\/I:L\/A:N",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "NONE",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "LOW",
                        "availabilityImpact": "NONE"
                    },
                    "exploitabilityScore": 3.9,
                    "impactScore": 2.5
                },
                {
                    "source": "nvd@nist.gov",
                    "type": "Primary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:N\/S:U\/C:L\/I:L\/A:N",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "NONE",
                        "userInteraction": "NONE",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "LOW",
                        "integrityImpact": "LOW",
                        "availabilityImpact": "NONE"
                    },
                    "exploitabilityScore": 3.9,
                    "impactScore": 2.5
                }
            ]
        },
        "weaknesses": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "description": [
                    {
                        "lang": "en",
                        "value": "CWE-639"
                    }
                ]
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "description": [
                    {
                        "lang": "en",
                        "value": "CWE-639"
                    }
                ]
            }
        ],
        "configurations": [
            {
                "nodes": [
                    {
                        "operator": "OR",
                        "negate": false,
                        "cpeMatch": [
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*",
                                "versionEndExcluding": "1.28.7",
                                "matchCriteriaId": "C5E423BE-4022-47AB-A5D4-B218627517DD"
                            },
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*",
                                "versionStartIncluding": "1.29.0",
                                "versionEndExcluding": "1.29.9",
                                "matchCriteriaId": "E442EF13-A99D-42B9-BC76-AC398C32D132"
                            },
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*",
                                "versionStartIncluding": "1.30.0",
                                "versionEndExcluding": "1.30.6",
                                "matchCriteriaId": "D9685C62-CFE4-43C5-B0C2-1C6722FB4F64"
                            },
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*",
                                "versionStartIncluding": "1.31.0",
                                "versionEndExcluding": "1.31.2",
                                "matchCriteriaId": "C765FFC0-2FF7-4318-A347-2AFCAD0E7C74"
                            }
                        ]
                    }
                ]
            }
        ],
        "references": [
            {
                "url": "https:\/\/github.com\/envoyproxy\/envoy\/security\/advisories\/GHSA-ffhv-fvxq-r6mf",
                "source": "security-advisories@github.com",
                "tags": [
                    "Third Party Advisory"
                ]
            }
        ]
    }
}