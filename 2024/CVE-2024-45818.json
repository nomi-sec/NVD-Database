{
    "id": "CVE-2024-45818",
    "sourceIdentifier": "security@xen.org",
    "published": "2024-12-19T12:15:16.540",
    "lastModified": "2025-05-20T16:28:07.217",
    "vulnStatus": "Analyzed",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "The hypervisor contains code to accelerate VGA memory accesses for HVM\nguests, when the (virtual) VGA is in \"standard\" mode.  Locking involved\nthere has an unusual discipline, leaving a lock acquired past the\nreturn from the function that acquired it.  This behavior results in a\nproblem when emulating an instruction with two memory accesses, both of\nwhich touch VGA memory (plus some further constraints which aren't\nrelevant here).  When emulating the 2nd access, the lock that is already\nbeing held would be attempted to be re-acquired, resulting in a\ndeadlock.\n\nThis deadlock was already found when the code was first introduced, but\nwas analysed incorrectly and the fix was incomplete.  Analysis in light\nof the new finding cannot find a way to make the existing locking\ndiscipline work.\n\nIn staging, this logic has all been removed because it was discovered\nto be accidentally disabled since Xen 4.7.  Therefore, we are fixing the\nlocking problem by backporting the removal of most of the feature.  Note\nthat even with the feature disabled, the lock would still be acquired\nfor any accesses to the VGA MMIO region."
        },
        {
            "lang": "es",
            "value": "El hipervisor contiene c\u00f3digo para acelerar los accesos a la memoria VGA para los invitados HVM, cuando el VGA (virtual) est\u00e1 en modo \"est\u00e1ndar\". El bloqueo involucrado all\u00ed tiene una disciplina inusual, dejando un bloqueo adquirido m\u00e1s all\u00e1 del retorno de la funci\u00f3n que lo adquiri\u00f3. Este comportamiento genera un problema al emular una instrucci\u00f3n con dos accesos a la memoria, ambos de los cuales tocan la memoria VGA (adem\u00e1s de algunas restricciones adicionales que no son relevantes aqu\u00ed). Al emular el segundo acceso, se intentar\u00eda volver a adquirir el bloqueo que ya se mantiene, lo que resultar\u00eda en un bloqueo. Este bloqueo ya se encontr\u00f3 cuando se introdujo el c\u00f3digo por primera vez, pero se analiz\u00f3 incorrectamente y la soluci\u00f3n fue incompleta. El an\u00e1lisis a la luz del nuevo hallazgo no puede encontrar una manera de hacer que funcione la disciplina de bloqueo existente. En la etapa de preparaci\u00f3n, se elimin\u00f3 toda esta l\u00f3gica porque se descubri\u00f3 que se hab\u00eda deshabilitado accidentalmente desde Xen 4.7. Por lo tanto, estamos solucionando el problema de bloqueo al incorporar la eliminaci\u00f3n de la mayor parte de la funci\u00f3n. Tenga en cuenta que incluso con la funci\u00f3n deshabilitada, el bloqueo a\u00fan se adquirir\u00eda para cualquier acceso a la regi\u00f3n MMIO de VGA."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:L\/AC:L\/PR:L\/UI:N\/S:C\/C:H\/I:N\/A:N",
                    "baseScore": 6.5,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "LOCAL",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "LOW",
                    "userInteraction": "NONE",
                    "scope": "CHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2,
                "impactScore": 4
            }
        ]
    },
    "weaknesses": [
        {
            "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-667"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:xen:xen:*:*:*:*:*:*:x86:*",
                            "versionStartIncluding": "4.6.0",
                            "versionEndExcluding": "4.20.0",
                            "matchCriteriaId": "D0B4A3E0-200C-492E-813C-D9EA47E2A66F"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https:\/\/xenbits.xenproject.org\/xsa\/advisory-463.html",
            "source": "security@xen.org",
            "tags": [
                "Patch",
                "Vendor Advisory"
            ]
        },
        {
            "url": "http:\/\/www.openwall.com\/lists\/oss-security\/2024\/11\/12\/2",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "http:\/\/xenbits.xen.org\/xsa\/advisory-463.html",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Vendor Advisory"
            ]
        }
    ]
}