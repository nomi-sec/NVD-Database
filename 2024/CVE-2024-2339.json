{
    "id": "CVE-2024-2339",
    "sourceIdentifier": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007",
    "published": "2024-03-08T20:15:46.170",
    "lastModified": "2025-02-12T16:44:09.467",
    "vulnStatus": "Analyzed",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "PostgreSQL Anonymizer v1.2 contains a vulnerability  that allows a user who owns a table to elevate to superuser. A user can define a masking function for a column and place malicious code in that function. When a privileged user applies the masking rules using the static masking or the anonymous dump method, the malicious code is executed and can grant escalated privileges to the malicious user. PostgreSQL Anonymizer v1.2 does provide a protection against this risk with the restrict_to_trusted_schemas option, but that protection is incomplete. Users that don't own a table, especially masked users cannot exploit this vulnerability. The problem is resolved in v1.3."
        },
        {
            "lang": "es",
            "value": "PostgreSQL Anonymizer v1.2 contiene una vulnerabilidad que permite a un usuario propietario de una tabla ascender a superusuario. Un usuario puede definir una funci\u00f3n de enmascaramiento para una columna y colocar c\u00f3digo malicioso en esa funci\u00f3n. Cuando un usuario privilegiado aplica las reglas de enmascaramiento mediante el enmascaramiento est\u00e1tico o el m\u00e9todo de volcado an\u00f3nimo, el c\u00f3digo malicioso se ejecuta y puede otorgar privilegios aumentados al usuario malintencionado. PostgreSQL Anonymizer v1.2 proporciona protecci\u00f3n contra este riesgo con la opci\u00f3n restrict_to_trusted_schemas, pero esa protecci\u00f3n est\u00e1 incompleta. Los usuarios que no poseen una mesa, especialmente los usuarios enmascarados, no pueden aprovechar esta vulnerabilidad. El problema se resuelve en v1.3."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:N\/AC:H\/PR:H\/UI:N\/S:C\/C:H\/I:H\/A:H",
                    "baseScore": 8,
                    "baseSeverity": "HIGH",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "HIGH",
                    "userInteraction": "NONE",
                    "scope": "CHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 1.3,
                "impactScore": 6
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:L\/UI:N\/S:U\/C:H\/I:H\/A:H",
                    "baseScore": 8.8,
                    "baseSeverity": "HIGH",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "LOW",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 2.8,
                "impactScore": 5.9
            }
        ]
    },
    "weaknesses": [
        {
            "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-20"
                }
            ]
        },
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "NVD-CWE-noinfo"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:dalibo:anonymizer:1.2.0:*:*:*:*:postgresql:*:*",
                            "matchCriteriaId": "502E5DD4-11FB-47F1-8F8C-ECA6C02130B6"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https:\/\/gitlab.com\/dalibo\/postgresql_anonymizer\/-\/commit\/e517b38e62e50871b04011598e73a7308bdae9d9",
            "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007",
            "tags": [
                "Patch"
            ]
        },
        {
            "url": "https:\/\/gitlab.com\/dalibo\/postgresql_anonymizer\/-\/commit\/e517b38e62e50871b04011598e73a7308bdae9d9",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch"
            ]
        }
    ]
}