{
    "cve": {
        "id": "CVE-2024-39315",
        "sourceIdentifier": "security-advisories@github.com",
        "published": "2024-07-02T20:15:06.110",
        "lastModified": "2025-04-11T14:47:52.863",
        "vulnStatus": "Analyzed",
        "cveTags": [],
        "descriptions": [
            {
                "lang": "en",
                "value": "Pomerium is an identity and context-aware access proxy. Prior to version 0.26.1, the Pomerium user info page (at `\/.pomerium`) unintentionally included serialized OAuth2 access and ID tokens from the logged-in user's session. These tokens are not intended to be exposed to end users. This issue may be more severe in the presence of a cross-site scripting vulnerability in an upstream application proxied through Pomerium. If an attacker could insert a malicious script onto a web page proxied through Pomerium, that script could access these tokens by making a request to the `\/.pomerium` endpoint. Upstream applications that authenticate only the ID token may be vulnerable to user impersonation using a token obtained in this manner. Note that an OAuth2 access token or ID token by itself is not sufficient to hijack a user's Pomerium session. Upstream applications should not be vulnerable to user impersonation via these tokens provided the application verifies the Pomerium JWT for each request, the connection between Pomerium and the application is secured by mTLS, or the connection between Pomerium and the application is otherwise secured at the network layer. The issue is patched in Pomerium v0.26.1. No known workarounds are available."
            },
            {
                "lang": "es",
                "value": "Pomerium es un proxy de acceso consciente de la identidad y el contexto. Antes de la versi\u00f3n 0.26.1, la p\u00e1gina de informaci\u00f3n del usuario de Pomerium (en `\/.pomerium`) inclu\u00eda involuntariamente tokens de ID y acceso OAuth2 serializados de la sesi\u00f3n del usuario que hab\u00eda iniciado sesi\u00f3n. Estos tokens no est\u00e1n destinados a ser expuestos a los usuarios finales. Este problema puede ser m\u00e1s grave en presencia de una vulnerabilidad de cross-site scripting en una aplicaci\u00f3n ascendente enviada a trav\u00e9s de Pomerium. Si un atacante pudiera insertar un script malicioso en una p\u00e1gina web proxy a trav\u00e9s de Pomerium, ese script podr\u00eda acceder a estos tokens realizando una solicitud al endpoint `\/.pomerium`. Las aplicaciones ascendentes que autentican solo el token de ID pueden ser vulnerables a la suplantaci\u00f3n del usuario utilizando un token obtenido de esta manera. Tenga en cuenta que un token de acceso OAuth2 o un token de identificaci\u00f3n por s\u00ed solo no es suficiente para secuestrar la sesi\u00f3n de Pomerium de un usuario. Las aplicaciones ascendentes no deben ser vulnerables a la suplantaci\u00f3n del usuario a trav\u00e9s de estos tokens, siempre que la aplicaci\u00f3n verifique el Pomerium JWT para cada solicitud, la conexi\u00f3n entre Pomerium y la aplicaci\u00f3n est\u00e9 protegida por mTLS, o la conexi\u00f3n entre Pomerium y la aplicaci\u00f3n est\u00e9 asegurada de otro modo en la capa de red. . El problema se solucion\u00f3 en Pomerium v0.26.1. No hay workarounds disponibles."
            }
        ],
        "metrics": {
            "cvssMetricV31": [
                {
                    "source": "security-advisories@github.com",
                    "type": "Secondary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:L\/UI:R\/S:U\/C:H\/I:N\/A:N",
                        "baseScore": 5.7,
                        "baseSeverity": "MEDIUM",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "LOW",
                        "userInteraction": "REQUIRED",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "NONE",
                        "availabilityImpact": "NONE"
                    },
                    "exploitabilityScore": 2.1,
                    "impactScore": 3.6
                },
                {
                    "source": "nvd@nist.gov",
                    "type": "Primary",
                    "cvssData": {
                        "version": "3.1",
                        "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:R\/S:U\/C:H\/I:N\/A:N",
                        "baseScore": 6.5,
                        "baseSeverity": "MEDIUM",
                        "attackVector": "NETWORK",
                        "attackComplexity": "LOW",
                        "privilegesRequired": "NONE",
                        "userInteraction": "REQUIRED",
                        "scope": "UNCHANGED",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "NONE",
                        "availabilityImpact": "NONE"
                    },
                    "exploitabilityScore": 2.8,
                    "impactScore": 3.6
                }
            ]
        },
        "weaknesses": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "description": [
                    {
                        "lang": "en",
                        "value": "CWE-201"
                    }
                ]
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "description": [
                    {
                        "lang": "en",
                        "value": "NVD-CWE-noinfo"
                    }
                ]
            }
        ],
        "configurations": [
            {
                "nodes": [
                    {
                        "operator": "OR",
                        "negate": false,
                        "cpeMatch": [
                            {
                                "vulnerable": true,
                                "criteria": "cpe:2.3:a:pomerium:pomerium:*:*:*:*:*:*:*:*",
                                "versionEndExcluding": "0.26.1",
                                "matchCriteriaId": "32A1EDDC-35D1-4A8A-BCD1-DC1810F385ED"
                            }
                        ]
                    }
                ]
            }
        ],
        "references": [
            {
                "url": "https:\/\/github.com\/pomerium\/pomerium\/commit\/4c7c4320afb2ced70ba19b46de1ac4383f3daa48",
                "source": "security-advisories@github.com",
                "tags": [
                    "Patch"
                ]
            },
            {
                "url": "https:\/\/github.com\/pomerium\/pomerium\/security\/advisories\/GHSA-rrqr-7w59-637v",
                "source": "security-advisories@github.com",
                "tags": [
                    "Vendor Advisory"
                ]
            },
            {
                "url": "https:\/\/github.com\/pomerium\/pomerium\/commit\/4c7c4320afb2ced70ba19b46de1ac4383f3daa48",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Patch"
                ]
            },
            {
                "url": "https:\/\/github.com\/pomerium\/pomerium\/security\/advisories\/GHSA-rrqr-7w59-637v",
                "source": "af854a3a-2127-422b-91ae-364da2661108",
                "tags": [
                    "Vendor Advisory"
                ]
            }
        ]
    }
}