{
    "id": "CVE-2024-22423",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2024-04-09T18:15:08.150",
    "lastModified": "2024-11-21T08:56:15.637",
    "vulnStatus": "Awaiting Analysis",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "yt-dlp is a youtube-dl fork with additional features and fixes. The patch that addressed CVE-2023-40581 attempted to prevent RCE when using `--exec` with `%q` by replacing double quotes with two double quotes. However, this escaping is not sufficient, and still allows expansion of environment variables. Support for output template expansion in `--exec`, along with this vulnerable behavior, was added to `yt-dlp` in version 2021.04.11. yt-dlp version 2024.04.09 fixes this issue by properly escaping `%`. It replaces them with `%%cd:~,%`, a variable that expands to nothing, leaving only the leading percent. It is recommended to upgrade yt-dlp to version 2024.04.09 as soon as possible. Also, always be careful when using `--exec`, because while this specific vulnerability has been patched, using unvalidated input in shell commands is inherently dangerous. For Windows users who are not able to upgrade, avoid using any output template expansion in `--exec` other than `{}` (filepath); if expansion in `--exec` is needed, verify the fields you are using do not contain `\"`, `|` or `&`; and\/or instead of using `--exec`, write the info json and load the fields from it instead."
        },
        {
            "lang": "es",
            "value": "yt-dlp es una bifurcaci\u00f3n de youtube-dl con funciones y correcciones adicionales. El parche que solucion\u00f3 CVE-2023-40581 intent\u00f3 evitar RCE al usar `--exec` con `%q` reemplazando comillas dobles con dos comillas dobles. Sin embargo, este escape no es suficiente y a\u00fan permite la expansi\u00f3n de las variables de entorno. La compatibilidad con la expansi\u00f3n de la plantilla de salida en `--exec`, junto con este comportamiento vulnerable, se agreg\u00f3 a `yt-dlp` en la versi\u00f3n 2021.04.11. La versi\u00f3n 2024.04.09 de yt-dlp soluciona este problema al escapar correctamente de `%`. Los reemplaza con `%%cd:~,%`, una variable que se expande a nada, dejando solo el porcentaje principal. Se recomienda actualizar yt-dlp a la versi\u00f3n 2024.04.09 lo antes posible. Adem\u00e1s, siempre tenga cuidado al usar `--exec`, porque si bien esta vulnerabilidad espec\u00edfica ha sido parcheada, usar entradas no validadas en los comandos del shell es intr\u00ednsecamente peligroso. Para los usuarios de Windows que no pueden actualizar, evite usar cualquier expansi\u00f3n de plantilla de salida en `--exec` que no sea `{}` (ruta de archivo); si se necesita expansi\u00f3n en `--exec`, verifique que los campos que est\u00e1 usando no contengan `\"`, `|` o `&amp;`; y\/o en lugar de usar `--exec`, escriba la informaci\u00f3n json y cargue los campos de \u00e9l en su lugar."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1\/AV:N\/AC:H\/PR:N\/UI:R\/S:C\/C:H\/I:H\/A:H",
                    "baseScore": 8.3,
                    "baseSeverity": "HIGH",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "NONE",
                    "userInteraction": "REQUIRED",
                    "scope": "CHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 1.6,
                "impactScore": 6
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-78"
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/commit\/de015e930747165dbb8fcd360f8775fd973b7d6e",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/commit\/ff07792676f404ffff6ee61b5638c9dc1a33a37a",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/releases\/tag\/2021.04.11",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/releases\/tag\/2024.04.09",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/security\/advisories\/GHSA-42h4-v29r-42qg",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/security\/advisories\/GHSA-hjq6-52gw-2g7p",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https:\/\/www.kb.cert.org\/vuls\/id\/123335",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/commit\/de015e930747165dbb8fcd360f8775fd973b7d6e",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/commit\/ff07792676f404ffff6ee61b5638c9dc1a33a37a",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/releases\/tag\/2021.04.11",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/releases\/tag\/2024.04.09",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/security\/advisories\/GHSA-42h4-v29r-42qg",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https:\/\/github.com\/yt-dlp\/yt-dlp\/security\/advisories\/GHSA-hjq6-52gw-2g7p",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https:\/\/www.kb.cert.org\/vuls\/id\/123335",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        }
    ]
}